(()=>{"use strict";var e={n:t=>{var i=t&&t.__esModule?()=>t.default:()=>t;return e.d(i,{a:i}),i},d:(t,i)=>{for(var s in i)e.o(i,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:i[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t);const i=window.wp.element,s=window.wp.blocks,o=window.wp.blockEditor,r=window.wp.components,a=e=>{const{geshi:t,startingLine:s,highlightLines:o,content:r}=e.attributes,a=document.createElement("pre");return a.setAttribute("lang",t),a.setAttribute("line",s),a.setAttribute("highlight",o),a.setAttribute("escaped",1),a.innerHTML=r,(0,i.createElement)("div",{style:{overflow:"auto"}},(0,i.createElement)("pre",null,a.outerHTML))},l=e=>{let{viewMode:t,setViewMode:s}=e;return(0,i.createElement)("div",{className:"codemirror-block"},(0,i.createElement)(r.Panel,{className:"components-panel__header edit-post-sidebar-header edit-post-sidebar__panel-tabs"},(0,i.createElement)("ul",{className:"codemirror-tabs"},(0,i.createElement)("li",null,(0,i.createElement)("button",{className:"components-button edit-post-sidebar__panel-tab "+("visual"===t?"is-active":""),onClick:()=>s("visual")},"Visual")),(0,i.createElement)("li",null,(0,i.createElement)("button",{className:"components-button edit-post-sidebar__panel-tab "+("generated"===t?"is-active":""),onClick:()=>s("generated")},"Generated")))))},n=window.lodash,d=window.jQuery;var m=e.n(d);const g=e=>{const t=(0,i.useRef)(null),[s,o]=(0,i.useState)();return(0,i.useEffect)((()=>{if(s||!t.current)return;const i=wp.codeEditor.defaultSettings?(0,n.clone)(wp.codeEditor.defaultSettings):{};i.codemirror=(0,n.extend)({},i.codemirror,{mode:e.attributes.mode,firstLineNumber:e.attributes.startingLine,lineWrapping:!1,lint:!1}),window.CodeMirror=wp.CodeMirror;const r=wp.codeEditor.initialize(t.current,i);r.codemirror.on("change",(function(t){e.setAttributes({content:t.getValue()})})),o(r),m()(t.current).data("initiated",!0)}),[t.current]),(0,i.useEffect)((()=>{s&&(e.attributes.mode in wp.CodeMirror.modes?s.codemirror.setOption("mode",e.attributes.mode):m().ajax({url:"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.52.2/mode/"+e.attributes.mode+"/"+e.attributes.mode+".min.js",dataType:"script",success(){s.codemirror.setOption("mode",e.attributes.mode)},async:!0}))}),[e.attributes.mode,s]),(0,i.useEffect)((()=>{s&&s.codemirror.setOption("firstLineNumber",parseInt(e.attributes.startingLine))}),[e.attributes.startingLine]),(0,i.createElement)(r.BaseControl,null,(0,i.createElement)("textarea",{ref:t},e.attributes.content))},c=e=>{const[t,s]=(0,i.useState)("visual");return(0,i.createElement)(i.Fragment,null,(0,i.createElement)(l,{viewMode:t,setViewMode:s}),"visual"===t&&(0,i.createElement)(g,e),"visual"!==t&&(0,i.createElement)(a,e))},h=[{mode:"apl",geshi:"applescript"},{mode:"clike",geshi:"c"},{mode:"clojure",geshi:"clojure"},{mode:"cmake",geshi:"cmake"},{mode:"cobol",geshi:"cobol"},{mode:"coffeescript",geshi:"coffeescript"},{mode:"commonlisp",geshi:"lisp"},{mode:"css",geshi:"css"},{mode:"d",geshi:"d"},{mode:"dart",geshi:"dart"},{mode:"diff",geshi:"diff"},{mode:"eiffel",geshi:"eiffel"},{mode:"erlang",geshi:"erlang"},{mode:"go",geshi:"go"},{mode:"groovy",geshi:"groovy"},{mode:"handlebars",geshi:"twig"},{mode:"haskell",geshi:"haskell"},{mode:"haskell-literate",geshi:"haskell"},{mode:"haxe",geshi:"haxe"},{mode:"htmlembedded",geshi:"html5"},{mode:"htmlmixed",geshi:"html5"},{mode:"idl",geshi:"idl"},{mode:"javascript",geshi:"javascript"},{mode:"jsx",geshi:"javascript"},{mode:"julia",geshi:"julia"},{mode:"lua",geshi:"lua"},{mode:"mathematica",geshi:"mathematica"},{mode:"mirc",geshi:"mirc"},{mode:"nginx",geshi:"nginx"},{mode:"nsis",geshi:"nsis"},{mode:"octave",geshi:"octave"},{mode:"oz",geshi:"oz"},{mode:"pascal",geshi:"pascal"},{mode:"perl",geshi:"perl"},{mode:"php",geshi:"php"},{mode:"powershell",geshi:"powershell"},{mode:"properties",geshi:"properties"},{mode:"python",geshi:"python"},{mode:"q",geshi:"q"},{mode:"rpm",geshi:"rpmspec"},{mode:"ruby",geshi:"ruby"},{mode:"rust",geshi:"rust"},{mode:"sas",geshi:"sas"},{mode:"sass",geshi:"sass"},{mode:"scheme",geshi:"scheme"},{mode:"shell",geshi:"bash"},{mode:"smalltalk",geshi:"smalltalk"},{mode:"smarty",geshi:"smarty"},{mode:"sparql",geshi:"sparql"},{mode:"sql",geshi:"sql"},{mode:"swift",geshi:"swift"},{mode:"tcl",geshi:"tcl"},{mode:"twig",geshi:"twig"},{mode:"vb",geshi:"vb"},{mode:"vbscript",geshi:"vbscript"},{mode:"verilog",geshi:"verilog"},{mode:"vhdl",geshi:"vhdl"},{mode:"vue",geshi:"twig"},{mode:"xml",geshi:"xml"},{mode:"yaml",geshi:"yaml"},{mode:"z80",geshi:"z80"}];(0,s.registerBlockType)("flynsarmy/syntax-editor",{title:"Code Block",icon:"editor-code",category:"formatting",description:"Displays a syntax-highlighted code snippet.",attributes:{content:{type:"string",default:""},mode:{type:"string",default:"php"},geshi:{type:"string",default:"php"},startingLine:{type:"integer",default:1},highlightLines:{type:"string"}},edit(e){const{setAttributes:t}=e;return(0,i.createElement)(i.Fragment,null,(0,i.createElement)(o.InspectorControls,null,(0,i.createElement)(r.PanelBody,{title:"Code Settings"},(0,i.createElement)(r.SelectControl,{label:"Language",onChange:e=>{const i=h.filter((t=>t.mode===e))[0];t({mode:e,geshi:i.geshi})},value:e.attributes.mode,options:h.flatMap((e=>({value:e.mode,label:e.mode})))}),(0,i.createElement)(r.TextControl,{type:"integer",label:"Starting line number.",value:e.attributes.startingLine,help:"Set to 0 to hide line numbers.",onChange:e=>{const i=parseInt(e.replace(/([^0-9]+)/gi,""));t({startingLine:isNaN(i)?0:i})},style:{width:"100%"}}),(0,i.createElement)(r.TextControl,{type:"string",label:"Highlight the specified lines.",value:e.attributes.highlightLines,help:"e.g 3-5, 10, 12",onChange:e=>{t({highlightLines:e.replace(/([^0-9,\-]*)/gi,"")})},style:{width:"100%"}}))),(0,i.createElement)(c,e))},save:e=>(0,i.createElement)("pre",{lang:e.attributes.mode,line:e.attributes.startingLine,highlight:e.attributes.highlightLines},e.attributes.content)}),this.FlynSyntax=t})();